[{"_id":{"$objectID":"59ab3c5ef43ed31314c3bb7a"},"code":"this.debug(this.args);\nthis.entityRepo.get(\"Department\", Object.assign({}, this.args.query || {}, { domain: this.args.$user.domain||this.args.$requestContext.dynamodomain }), (er, deps) => {\n  if (er) return callback(er);\n  if (!deps.length) return callback(null, deps);\n  callback(\n    null,\n    deps.map(x => {\n      let result = {\n        id: x._id,\n        displayLabel: x.name,\n        elements: []\n      };\n\n      if (x.areasOfSpecialization && x.areasOfSpecialization.length)\n        result.elements.push(\n          this.libs.createElement(\"areaOfSpecialization\", \"Area of Specialization\", \"\", this.constants.ELEMENTTYPE.SELECTSET, {\n            items: x.areasOfSpecialization.map(a => ({ id: a._id, displayLabel: a.name }))\n          })\n        );\n      return result;\n    })\n  );\n});\n","title":"Get Department And Areas of Specialization Set","requiresIdentity":false,"__v":0,"uid":"DEPARTMENTS_AND_AREA","standalone":true},{"_id":{"$objectID":"59b1051e9fcdd93b28dbf323"},"code":"this.debug('fetching School Programmes.');\nthis.debug(this.args);\nthis.libs.getEntity.call(this,'SchoolProgramme','name',callback);","title":"Get SchoolProgramme","uid":"GET_SCHOOLPROGRAMME","requiresIdentity":false,"__v":0,"standalone":true},{"_id":{"$objectID":"5a6abc4cb0e23c31183e6fbd"},"code":"this.libs.getDomain.call(this, (er, domain) => {\n  if (er) return callback(er);\n\n  let merchantConfig = this.libs.flattenByNamespace(\"remita\", domain.config);\n  this.debug(merchantConfig);\n  this.libs.confirmRemitaPayment.call(this, this.args.invoiceNumber, merchantConfig, domain, (er, status) => {\n    if (er) return callback(er);\n\n    if (!status) return callback(new Error(\"You have been unable to confirm payment has been made against \" + this.args.invoiceNumber));\n\n    this.debug('payment successfully confirmed');\n    callback(null, { _invoiceNumber: this.args.invoiceNumber });\n  });\n});\n","title":"Check RRR transaction status","uid":"CHECK_RRR_STATUS","requiresIdentity":true,"__v":0,"standalone":false},{"_id":{"$objectID":"5a6db8f34d6e022d3487d642"},"code":"this.debug(\"injecting personal/ next of kin details\");\n//this.debug(this.args);\n\nthis.libs.getNextOfKinDetailsUI.call(this, (er, kui) => {\n  if (er) return callback(er);\n  this.args.$nextStep.form.elements.unshift(...kui);\n  this.libs.getPersonalDetailsUI.call(this, (er, ui) => {\n    if (er) return callback(er);\n    this.args.$nextStep.form.elements.unshift(...ui);\n    return callback(null, this.args);\n  });\n});\n","title":"Inject personal Details and Next of Kin","requiresIdentity":true,"__v":0,"standalone":false},{"_id":{"$objectID":"5a6e0aecd58b164cf0d46f7e"},"code":"this.debug(\"inserting o lvl ui\");\n//this.debug(this.args);\nthis.libs.getOLevelDetailsUI.call(this, (er, ui) => {\n  if (er) return callback(er);\n  this.args.$nextStep.form.elements.push(...ui);\n  return callback(null, this.args);\n});\n","title":"Insert Olevel Details","requiresIdentity":true,"__v":0,"standalone":false},{"_id":{"$objectID":"5a6e0aecd58b164cf0d46f7f"},"code":"this.debug(\"inserting education history ui\");\n//this.debug(this.args);\nthis.libs.getEducationHistoryUI.call(this, (er, ui) => {\n  if (er) return callback(er);\n  this.args.$nextStep.form.elements.push(...ui);\n  return callback(null, this.args);\n});\n","title":"Insert Education History","requiresIdentity":true,"__v":0,"standalone":false},{"_id":{"$objectID":"5a6e0aecd58b164cf0d46f80"},"code":"this.debug(\"inserting employment history..\");\n//this.debug(this.args);\nthis.libs.getEmploymentHistoryUI.call(this, (er, ui) => {\n  if (er) return callback(er);\n  this.args.$nextStep.form.elements.push(...ui);\n  return callback(null, this.args);\n});\n","title":"Insert Employment History","requiresIdentity":true,"__v":0,"standalone":false},{"_id":{"$objectID":"5a70b34ea5538a22fc20eab4"},"code":"new this.libs.ExternalApplication(this).register(\n  \"jupebApplicationClass\",\n  [\"PERSONAL_DETAILS\"],\n  [\n    function(application, cb) {\n      let fac_dep = [\n        \"FACULTY_AND_DEPARTMENT\",\n        { faculty: application.department.faculty && application.department.faculty.name, department: application.department.name }\n      ];\n      fac_dep.name = \"Department\";\n      setImmediate(cb, null, [[\"BOOTSTRAP\"], fac_dep]);\n    }\n  ],\n  callback\n);\n","title":"Submit JUPEB Application Form","requiresIdentity":true,"__v":0,"standalone":false,"uid":"SUBMIT_JUPEB_FORM"},{"_id":{"$objectID":"5a70cb6ea5538a22fc20eac6"},"code":"//NOTE: No user should ever be issued a claim to call this processor\nthis.libs.getDomain.call(this, (er, domain) => {\n  if (er) return callback(er);\n  Object.defineProperties(this.args, {\n    $appDomain: {\n      enumerable: false,\n      get: function() {\n        return domain;\n      }\n    }\n  });\n  callback(null, this.args);\n});\n","title":"Get Domain Config [NEVER ISSUE THIS CLAIM TO ANY USER]","requiresIdentity":true,"uid":"GET_DOMAIN_CONFIG","__v":0,"standalone":false},{"_id":{"$objectID":"5a70d04344b59c3ba0660f18"},"code":"this.libs.confirmInvoiceIsFor.call(this,this.args.invoiceNumber, \"JUPEB_APP_FORM\", er => {\n  if (er) return callback(er);\n\n  return this.libs.skipApplicationIfAllowed.call(\n    this,\n    this.args.$appDomain.config.jupebApplicationClass,\n    \"SUBMIT_JUPEB_FORM\",\n    callback\n  );\n});\n","title":"Confirm invoice is for JUPEB","requiresIdentity":true,"__v":0,"standalone":false},{"_id":{"$objectID":"5a72b60d48dda81fc8cd8f15"},"code":"setImmediate(callback, null, (Object.keys(this.args).length && this.args) || null);\n","title":"Make args initial data for a process","requiresIdentity":true,"__v":0,"standalone":false,"uid":"ARGS_TO_DATA"},{"_id":{"$objectID":"5a76b5c516fdef36906796fa"},"code":"this.debug(\"confirming if invoice is for POST UTME SCREENING\");\nif (this.args.$user && Object.keys(this.args.$user).length > 0) {\n  this.debug(\"user tried to register while logged in.\");\n  callback(new Error(\"Unauthorized\"));\n} else\n  this.libs.confirmInvoiceIsFor.call(this, this.args.invoiceNumber, \"POST_UTME_SCREENING\", er => {\n    if (er) return callback(er);\n    return this.libs.skipApplicationIfAllowed.call(\n      this,\n      this.args.$appDomain.config.putmeApplicationClass,\n      \"SUBMIT_PUTME_APPLICATION\",\n      callback\n    );\n  });\n","title":"Confirm invoice is for Post UTME Screening","requiresIdentity":true,"__v":0,"standalone":false},{"_id":{"$objectID":"5a8e96ae1ff23628b05b2401"},"code":"var self = this;\nthis.libs.confirmInvoiceIsFor.call(this, this.args.invoiceNumber, \"SANDWICH_DIPLOMA_FORM\", er => {\n  if (er) return callback(er);\n\n//   self.debug(\"sandwich class is : \\n\" + self.args.$appDomain.config.sandwichDiplomaApplicationClass);\n  return self.libs.skipApplicationIfAllowed.call(self, self.args.$appDomain.config.sandwichDiplomaApplicationClass, \"SUBMIT_SANDWICH_DIPLOMA_FORM\", callback);\n});\n","title":"Confirm Invoice is for Sandwich","requiresIdentity":true,"standalone":false,"__v":0},{"_id":{"$objectID":"5a8e96ae1ff23628b05b2402"},"code":"new this.libs.ExternalApplication(this).register(\n  \"sandwichDiplomaApplicationClass\",\n  [\"PERSONAL_DETAILS\", \"OLEVEL_DETAILS\"],\n  [\n    function(application, cb) {\n      setImmediate(cb, null, [[\"TABLE_STYLES\"]]);\n    }\n  ],\n  callback\n);\n","title":"Submit Sandwich Diploma Application Form","requiresIdentity":false,"standalone":false,"__v":0,"uid":"SANDWICH_DIPLOMA_FORM"},{"_id":{"$objectID":"5a9533870af7e52b7852c996"},"code":"this.libs.accurateFormDeclarationUI.call(this, (er, ui) => {\n  if (er) return callback(er);\n  this.args.$nextStep.form.elements.push(...ui);\n  return callback(null, this.args);\n});\n","title":"Accurate Form declaration","requiresIdentity":false,"standalone":true,"__v":0},{"_id":{"$objectID":"5aa12e443d7616124416b187"},"code":"let index = 0,\n  e = (...rest) => {\n    index = index + 1;\n    return Object.assign({ order: index }, this.libs.createElement.apply(this, rest));\n  },\n  c = this.constants,\n  required = this.libs.createRequiredValidator,\n  sandwichDiplomaCourse = this.libs.createElement(\"sandwichDiplomaCourse\", \"SANDWICH DIPLOMA COURSE\", \"\", c.ELEMENTTYPE.SECTION, {\n    elements: [\n      e(\n        \"course\",\n        \"Course\",\n        \"\",\n        c.ELEMENTTYPE.SELECT,\n        {\n          type: \"PROCESSOR\",\n          config: {\n            value: \"Get_Courses\"\n          }\n        },\n        [required()]\n      ),\n      e(\n        \"hasAppliedForAdmission\",\n        \"Have you ever applied for admission into the University\",\n        \"\",\n        c.ELEMENTTYPE.SELECT,\n        {\n          type: \"PROCESSOR\",\n          config: {\n            value: \"YES_NO_OPTIONS\"\n          }\n        },\n        [required()]\n      ),\n      e(\"yearOfApplication\", \"When?\", \"\", c.ELEMENTTYPE.INPUT, {\n        type: \"date\"\n      }),\n      e(\n        \"wasOfferedAdmission\",\n        \"Were you offered admission?\",\n        \"\",\n        c.ELEMENTTYPE.SELECT,\n        {\n          type: \"PROCESSOR\",\n          config: {\n            value: \"YES_NO_OPTIONS\"\n          }\n        },\n        [required()]\n      )\n    ]\n  });\nthis.args.$nextStep.form.elements.push(sandwichDiplomaCourse);\nsetImmediate(callback, null, this.args);\n","title":"Sandwich Diploma Course UI","uid":"SANDWICH_DIPLOMA_COURSE_UI","requiresIdentity":false,"standalone":true,"__v":0},{"_id":{"$objectID":"5aadaa3a1d72c25720a6b67d"},"code":"this.entityRepo.get(this.args.$appDomain.config.invoiceClass, { invoiceNumber: this.args.invoiceNumber }, { one: true }, (er, invoice) => {\n  if (er) return callback(er);\n  if (!invoice) return callback(new Error(\"Cannot find any invoice with that invoice number\"));\n\n  return callback(\n    null,\n    Object.assign(this.args, {\n      personalDetails: {\n        firstName: invoice.extra.firstName,\n        surname: invoice.extra.surname,\n        middleName: invoice.extra.middleName\n      }\n    })\n  );\n});\n","title":"Get Firstname,Middlename and Surname from Invoice","requiresIdentity":true,"standalone":false,"__v":0},{"_id":{"$objectID":"5abcc2eab0e76c31248d736d"},"code":"this.entityRepo.getProcessor({ uid: this.args.$process.config.submitProcessor }, { one: true }, (er, processor) => {\n  if (er) return callback(er);\n  if (!processor) return callback(new Error(\"Review process not correctly setup. Cannot find final processor\"));\n  this.args.isConfirmation = true;\n  this.debug(\"have set confirmation to true\");\n  this.debug(\"calling submit processor\");\n  processor.process.call(this, result, callback);\n});\n","title":"Review confirmation","uid":"REVIEW_CONFIRMATION","requiresIdentity":true,"standalone":false,"__v":0}]
